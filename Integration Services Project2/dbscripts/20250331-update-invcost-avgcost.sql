--DROP TABLE "MIGRATION"."PATCH_20250331_INVCOST";
--CREATE TABLE "MIGRATION"."PATCH_20250331_INVCOST"  (
--		  "ID" BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (  
--		    START WITH +1  
--		    INCREMENT BY +1  
--		    MINVALUE +1  
--		    MAXVALUE +9223372036854775807  
--		    NO CYCLE  
--		    CACHE 20  
--		    NO ORDER ) , 
--		  "ITEMCODE" VARCHAR(50 OCTETS), 
--		  "AVGCOST" DECIMAL(28,12) 
--	)   
--	IN "USERSPACE1"  
--	ORGANIZE BY ROW;

-- COPY/IMPORT MIGRATION.PATCH_20250331_INVCOST FROM ON-PREM (NEL-A) PLATFORM
-- TODO MANUALLY

-- UPDATE INVCOST.AVGCOST FROM PATCH FILE
MERGE INTO MAXIMO.INVCOST A
USING (
	-- 29.402 ROWS
	SELECT A.INVCOSTID, A.ITEMNUM, C.ITEMCODE, C.AVGCOST
	FROM MAXIMO.INVCOST A
	JOIN MAXIMO.ITEM B ON B.ITEMNUM=A.ITEMNUM
	JOIN MIGRATION.PATCH_20250331_INVCOST C ON C.ITEMCODE=B.STE_CSWNITEMNO
) B ON B.INVCOSTID=A.INVCOSTID
WHEN MATCHED THEN
UPDATE SET
	AVGCOST=B.AVGCOST
;

